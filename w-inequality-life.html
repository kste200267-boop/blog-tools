<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>ğŸ² ì¶œë°œì„ ì´ ë‹¤ë¥¸ ì¸ìƒê²Œì„</title>
<link href="https://fonts.googleapis.com/css2?family=Jua&family=Noto+Sans+KR:wght@300;400;700;900&display=swap" rel="stylesheet">
<script src="https://cdn.tailwindcss.com"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<style>
*{box-sizing:border-box;margin:0;padding:0}
body{font-family:'Noto Sans KR',sans-serif;background:#0f172a;color:#e2e8f0;min-height:100vh;overflow-x:hidden}
.jua{font-family:'Jua',sans-serif}
.screen{display:none;animation:fadeUp .5s ease-out forwards;min-height:100vh}
.screen.active{display:flex;flex-direction:column}
@keyframes fadeUp{from{opacity:0;transform:translateY(25px)}to{opacity:1;transform:translateY(0)}}
@keyframes float{0%,100%{transform:translateY(0)}50%{transform:translateY(-8px)}}
@keyframes glow{0%,100%{box-shadow:0 0 20px rgba(234,179,8,0.3)}50%{box-shadow:0 0 40px rgba(234,179,8,0.6)}}
@keyframes shake{0%,100%{transform:translateX(0)}25%{transform:translateX(-5px)}75%{transform:translateX(5px)}}
.start-bg{background:linear-gradient(135deg,#1e1b4b 0%,#312e81 50%,#1e3a5f 100%)}
.char-card{background:rgba(30,41,59,0.8);border:2px solid #334155;border-radius:1rem;padding:1rem;transition:all .3s;text-align:center}
.char-card.mine{border-color:#eab308;background:rgba(234,179,8,0.1);box-shadow:0 0 20px rgba(234,179,8,0.15)}
.choice-btn{background:rgba(30,41,59,0.8);border:2px solid #334155;border-radius:1rem;padding:1.2rem;cursor:pointer;transition:all .3s;text-align:left;width:100%}
.choice-btn:hover{border-color:#8b5cf6;transform:translateY(-2px);background:rgba(139,92,246,0.1)}
.choice-btn.selected{border-color:#eab308;background:rgba(234,179,8,0.1)}
.insight-box{background:rgba(234,179,8,0.1);border:1px solid rgba(234,179,8,0.3);border-radius:1rem;padding:1rem}
.stat-mini{display:inline-block;padding:2px 8px;border-radius:99px;font-size:.7rem;font-weight:700}
.result-card{background:white;color:#1e293b;border-radius:1.5rem;max-width:600px;margin:0 auto;overflow:hidden}
.progress-bar{height:6px;background:#1e293b;border-radius:99px;overflow:hidden}
.progress-fill{height:100%;background:linear-gradient(90deg,#eab308,#ef4444);border-radius:99px;transition:width .5s}
@media(max-width:640px){.char-card{padding:.8rem}}

/* ì „ì²´í™”ë©´ ì´íƒˆ ê²½ê³  ì˜¤ë²„ë ˆì´ */
.fs-warning-overlay{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.92);z-index:9999;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:1.5rem;animation:fadeIn .3s}
.fs-warning-overlay .warn-icon{font-size:4rem;animation:shake .5s}
.fs-warning-overlay .warn-title{font-size:1.5rem;font-weight:900;color:#fbbf24}
.fs-warning-overlay .warn-msg{font-size:1rem;color:#94a3b8;text-align:center;max-width:320px;line-height:1.6}
.fs-warning-overlay .warn-btn{padding:14px 40px;background:linear-gradient(135deg,#3b82f6,#8b5cf6);border:none;border-radius:12px;color:#fff;font-size:1.1rem;font-weight:700;cursor:pointer;transition:transform .2s}
.fs-warning-overlay .warn-btn:hover{transform:scale(1.05)}
@keyframes fadeIn{from{opacity:0}to{opacity:1}}
/* ë¸”ë¡œê·¸ ë§í¬ ë°°ì§€ */
.blog-badge{position:fixed;bottom:12px;right:12px;z-index:100;background:rgba(15,23,42,0.85);border:1px solid #334155;border-radius:10px;padding:6px 14px;font-size:0.75rem;color:#94a3b8;text-decoration:none;backdrop-filter:blur(8px);transition:all .3s;display:flex;align-items:center;gap:6px}
.blog-badge:hover{background:rgba(59,130,246,0.2);border-color:#3b82f6;color:#60a5fa}
</style>
</head>
<body>

<!-- START -->
<div class="screen active start-bg" id="s-start">
  <div class="flex-1 flex flex-col items-center justify-center p-6 text-center">
    <div style="font-size:6rem;animation:float 3s ease-in-out infinite">ğŸ²</div>
    <h1 class="jua text-4xl md:text-5xl text-white mb-3 mt-4">ì¶œë°œì„ ì´ ë‹¤ë¥¸ ì¸ìƒê²Œì„</h1>
    <p class="text-yellow-200 text-lg mb-1">ê°™ì€ ì„ íƒ, ë‹¤ë¥¸ ê²°ê³¼</p>
    <p class="text-slate-400 text-sm mb-6 max-w-sm">4ëª…ì´ ê°™ì€ ì„ íƒì„ í•©ë‹ˆë‹¤. ê·¸ëŸ°ë° ì™œ ê²°ê³¼ê°€ ë‹¤ë¥¼ê¹Œìš”? ë‹¹ì‹ ì—ê²Œ ëœë¤ìœ¼ë¡œ ë°°ì •ëœ ìºë¦­í„°ì˜ ì¸ìƒì„ ì‚´ì•„ë³´ì„¸ìš”.</p>
    <div class="w-full max-w-xs space-y-3 mb-6">
      <div class="flex gap-2">
        <input type="text" id="input-grade" placeholder="í•™ë…„" maxlength="1" class="flex-1 text-center py-3 rounded-xl bg-white/10 text-white placeholder-slate-500 border border-white/20 font-bold outline-none focus:border-yellow-400">
        <input type="text" id="input-class" placeholder="ë°˜" maxlength="2" class="flex-1 text-center py-3 rounded-xl bg-white/10 text-white placeholder-slate-500 border border-white/20 font-bold outline-none focus:border-yellow-400">
        <input type="text" id="input-number" placeholder="ë²ˆí˜¸" maxlength="2" class="flex-1 text-center py-3 rounded-xl bg-white/10 text-white placeholder-slate-500 border border-white/20 font-bold outline-none focus:border-yellow-400">
      </div>
      <input type="text" id="input-name" placeholder="ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”" maxlength="10" class="w-full text-center py-3 rounded-xl bg-white/10 text-white placeholder-slate-500 border border-white/20 font-bold text-lg outline-none focus:border-yellow-400">
    </div>
    <button onclick="startGame()" class="py-4 px-12 bg-yellow-600 hover:bg-yellow-500 text-white rounded-2xl font-bold text-lg transition-all hover:scale-105 shadow-lg" style="animation:glow 2s infinite">ğŸ² ì¸ìƒ ì‹œì‘</button>
    <p class="text-slate-600 text-xs mt-4">â± ì•½ 10~12ë¶„ Â· 6ë¼ìš´ë“œ(ì¸ìƒ 6ë‹¨ê³„)</p>
  </div>
  <div class="text-center pb-4 text-slate-600 text-xs">í†µí•©ì‚¬íšŒ V. ì‚¬íšŒì •ì˜ì™€ ë¶ˆí‰ë“± Â· [10í†µì‚¬2-02-01]</div>
</div>

<!-- ASSIGN -->
<div class="screen" id="s-assign">
  <div class="flex-1 p-4 flex items-center justify-center">
    <div class="max-w-2xl w-full text-center" id="assign-content"></div>
  </div>
</div>

<!-- ROUND -->
<div class="screen" id="s-round">
  <div class="sticky top-0 z-50 bg-slate-900/90 backdrop-blur-md border-b border-slate-700 px-4 py-3">
    <div class="max-w-2xl mx-auto">
      <div class="flex justify-between items-center mb-2 text-sm">
        <span class="text-yellow-400 font-bold">ROUND <span id="r-num">1</span>/6</span>
        <span class="text-slate-400" id="r-stage"></span>
      </div>
      <div class="progress-bar"><div class="progress-fill" id="r-progress" style="width:0%"></div></div>
    </div>
  </div>
  <div class="flex-1 p-4 pb-24" id="r-content"></div>
</div>

<!-- RESULT -->
<div class="screen" id="s-result">
  <div class="flex-1 p-4 py-8">
    <div class="result-card" id="result-card">
      <div class="p-6 text-center" id="res-header" style="background:linear-gradient(135deg,#b45309,#92400e)">
        <div class="text-5xl mb-2">ğŸ²</div>
        <h1 class="jua text-2xl text-white">ì¸ìƒê²Œì„ ê²°ê³¼</h1>
        <p class="text-yellow-200 text-sm" id="res-subtitle"></p>
      </div>
      <div class="p-5" id="res-body"></div>
    </div>
    <div class="flex flex-wrap justify-center gap-3 mt-6 max-w-lg mx-auto">
      <button onclick="saveImg()" class="px-6 py-3 bg-yellow-600 hover:bg-yellow-500 text-white rounded-xl font-bold transition-all hover:scale-105">ğŸ“„ ê²°ê³¼ ì €ì¥</button>
      <button onclick="location.reload()" class="px-6 py-3 bg-slate-700 hover:bg-slate-600 text-white rounded-xl font-bold transition-all hover:scale-105">ğŸ”„ ë‹¤ì‹œ í•˜ê¸°</button>
      <button onclick="exitToBlog()" class="px-6 py-3 bg-emerald-600 hover:bg-emerald-500 text-white rounded-xl font-bold transition-all hover:scale-105">ğŸ“ ë¸”ë¡œê·¸ë¡œ ëŒì•„ê°€ê¸°</button>
    </div>
  </div>
</div>

<script>
let stu={name:'',grade:'',cls:'',num:''};
let myChar=0, round=0;

const CHARS=[
  {id:'A',name:'ìˆ˜ì•„',emoji:'ğŸ‘©â€ğŸ’¼',bg:'ì„œìš¸ ê°•ë‚¨',family:'ë¶€ëª¨ ê³ ì†Œë“ ë§ë²Œì´',extra:'ì‚¬êµìœ¡ í’ë¶€, í•´ì™¸ ê²½í—˜ ë‹¤ìˆ˜',color:'#3b82f6',
   multipliers:[1.5,1.4,1.3,1.3,1.4,1.5],startPt:80,desc:'í’ë¶€í•œ ìì› ì†ì—ì„œ ìë€ ìˆ˜ì•„'},
  {id:'B',name:'ì¤€í˜¸',emoji:'ğŸ‘¨â€ğŸ”§',bg:'ì§€ë°© ì¤‘ì†Œë„ì‹œ',family:'ë¶€ëª¨ ë§ë²Œì´(íšŒì‚¬ì›+ìì˜ì—…)',extra:'í‰ë²”í•œ ê³µêµìœ¡, í•™ì› 1ê°œ',color:'#10b981',
   multipliers:[1.0,1.0,1.0,1.0,1.0,1.0],startPt:50,desc:'í‰ë²”í•œ í™˜ê²½ì—ì„œ ì„±ì‹¤í•˜ê²Œ ìë€ ì¤€í˜¸'},
  {id:'C',name:'ë¯¼ì¬',emoji:'ğŸ‘¦',bg:'ë†ì´Œ ì§€ì—­',family:'í•œë¶€ëª¨(ì–´ë¨¸ë‹ˆ) + ì¡°ë¶€ëª¨',extra:'ê²½ì œì  ì–´ë ¤ì›€, í†µí•™ 1ì‹œê°„',color:'#f59e0b',
   multipliers:[0.7,0.7,0.65,0.7,0.65,0.6],startPt:25,desc:'ì–´ë ¤ìš´ í™˜ê²½ ì†ì—ì„œ ê¿‹ê¿‹ì´ ìë€ ë¯¼ì¬'},
  {id:'D',name:'í•˜ë‚˜',emoji:'ğŸ‘§',bg:'ìˆ˜ë„ê¶Œ ë‹¤ë¬¸í™” ê°€ì •',family:'ë¶€ëª¨(ì´ì£¼ ë°°ê²½)',extra:'ì–¸ì–´ ì¥ë²½, ì •ì²´ì„± ê³ ë¯¼, ë¬¸í™” ë‹¤ì–‘ì„±',color:'#ec4899',
   multipliers:[0.8,0.75,0.8,0.75,0.7,0.75],startPt:35,desc:'ë‘ ë¬¸í™” ì‚¬ì´ì—ì„œ ì„±ì¥í•œ í•˜ë‚˜'}
];

let points; // {A:n, B:n, C:n, D:n}
let roundLog=[];

const ROUNDS=[
  {stage:'ìœ ì•„ê¸° (5ì„¸)',title:'êµìœ¡ì˜ ì²« ì¶œë°œ',desc:'ì–´ë¦°ì´ì§‘/ìœ ì¹˜ì›ì„ ì„ íƒí•  ì‹œê°„ì…ë‹ˆë‹¤.',
   choices:[
    {text:'ğŸ« ì˜ì–´ìœ ì¹˜ì› + ì˜ˆì²´ëŠ¥',pts:15,icon:'ğŸŒŸ',note:'ìˆ˜ì•„ë§Œ ê°€ëŠ¥(ì›” 150ë§Œì›). ë‚˜ë¨¸ì§€ëŠ” ì¼ë°˜ìœ ì¹˜ì›.'},
    {text:'ğŸ“š ì¼ë°˜ ìœ ì¹˜ì› + ë…ì„œìŠµê´€',pts:10,icon:'ğŸ“–',note:'ëˆ„êµ¬ë‚˜ ì„ íƒ ê°€ëŠ¥. ê¾¸ì¤€í•œ ë…¸ë ¥.'},
    {text:'ğŸ¡ ê°€ì • ë³´ìœ¡ + ììœ  ë†€ì´',pts:5,icon:'ğŸ§¸',note:'ê²½ì œì  ë¶€ë‹´ ì—†ìŒ. ì‚¬íšŒì„± ë°œë‹¬ì€ ëŠë¦´ ìˆ˜ ìˆìŒ.'}
   ],
   insight:'ê°™ì€ "ì˜ì–´ìœ ì¹˜ì›"ì„ ì„ íƒí•´ë„ ìˆ˜ì•„ëŠ” +22ì , ë¯¼ì¬ëŠ” +10ì ì…ë‹ˆë‹¤. ê°€ì • í™˜ê²½ì´ êµìœ¡ íš¨ê³¼ì— í° ì˜í–¥ì„ ë¯¸ì¹©ë‹ˆë‹¤. ì‹¤ì œë¡œ ë¶€ëª¨ì˜ ì†Œë“ ìˆ˜ì¤€ì€ ìë…€ì˜ ì–´íœ˜ë ¥Â·ì¸ì§€ ë°œë‹¬ê³¼ ë†’ì€ ìƒê´€ê´€ê³„ë¥¼ ë³´ì…ë‹ˆë‹¤.'},
  {stage:'ì´ˆë“±í•™êµ (10ì„¸)',title:'ë°©ê³¼ í›„ ì‹œê°„',desc:'í•™êµê°€ ëë‚œ í›„ ë¬´ì—‡ì„ í•˜ë‚˜ìš”?',
   choices:[
    {text:'ğŸ“ í•™ì› 3ê°œ + ê³¼ì™¸',pts:18,icon:'ğŸ“š',note:'ìˆ˜ì•„: ìˆ˜í•™Â·ì˜ì–´Â·ì½”ë”©. ë¯¼ì¬: ëŒë´„êµì‹¤ë§Œ ê°€ëŠ¥.'},
    {text:'âš½ ë°©ê³¼í›„í•™êµ + ìš´ë™',pts:12,icon:'ğŸƒ',note:'í•™êµ í”„ë¡œê·¸ë¨. ë¹„ìš© ë¶€ë‹´ ì ìŒ.'},
    {text:'ğŸ® ììœ ì‹œê°„ + ë…í•™',pts:7,icon:'ğŸ’ª',note:'ìŠ¤ìŠ¤ë¡œ ê³µë¶€. ìê¸°ì£¼ë„ì„±ì€ ë†’ì§€ë§Œ í•œê³„ ì¡´ì¬.'}
   ],
   insight:'"í•™ì› 3ê°œ"ë¥¼ ì„ íƒí•´ë„ ìˆ˜ì•„ëŠ” +25ì , ë¯¼ì¬ëŠ” +12ì ì…ë‹ˆë‹¤. ì‚¬êµìœ¡ë¹„ëŠ” ì†Œë“ ìƒìœ„ 20% ê°€êµ¬ê°€ í•˜ìœ„ 20%ì˜ 5ë°°ë¥¼ ì§€ì¶œí•©ë‹ˆë‹¤(í†µê³„ì²­, 2023). ì´ ê²©ì°¨ê°€ ì„±ì  ì°¨ì´ë¡œ ì´ì–´ì§‘ë‹ˆë‹¤.'},
  {stage:'ì¤‘í•™êµ (15ì„¸)',title:'ì§„ë¡œ íƒìƒ‰ì˜ ì‹œê°„',desc:'ë¯¸ë˜ë¥¼ ìœ„í•´ ì–´ë–¤ í™œë™ì„ í•˜ë‚˜ìš”?',
   choices:[
    {text:'ğŸ”¬ ì§„ë¡œìº í”„ + ë©˜í† ë§',pts:16,icon:'ğŸ¯',note:'ìˆ˜ì•„: ë¶€ëª¨ ë„¤íŠ¸ì›Œí¬. í•˜ë‚˜: ì–¸ì–´ ì¥ë²½ìœ¼ë¡œ ì°¸ì—¬ ì–´ë ¤ì›€.'},
    {text:'ğŸ“ ë‚´ì‹  ì§‘ì¤‘ + ë´‰ì‚¬í™œë™',pts:11,icon:'ğŸ“Š',note:'ì•ˆì •ì  ì„ íƒ. ëˆ„êµ¬ë‚˜ ê°€ëŠ¥.'},
    {text:'ğŸ¨ ì˜ˆì²´ëŠ¥ íŠ¹ê¸° ê°œë°œ',pts:8,icon:'ğŸµ',note:'ì¬ëŠ¥ ìˆìœ¼ë©´ ê¸°íšŒ. ë ˆìŠ¨ë¹„ ë¶€ë‹´.'}
   ],
   insight:'ì§„ë¡œ íƒìƒ‰ ê¸°íšŒë„ ë¶ˆí‰ë“±í•©ë‹ˆë‹¤. ë¶€ëª¨ì˜ í•™ë ¥Â·ì§ì—…ì´ ìë…€ì˜ ì§„ë¡œ ì¸ì‹ì— ì˜í–¥ì„ ì¤ë‹ˆë‹¤. "ë¶€ëª¨ê°€ ì•„ëŠ” ì§ì—…ì˜ ìˆ˜"ê°€ ìë…€ì˜ ê¿ˆì˜ ë²”ìœ„ë¥¼ ê²°ì •í•œë‹¤ëŠ” ì—°êµ¬ë„ ìˆìŠµë‹ˆë‹¤.'},
  {stage:'ê³ ë“±í•™êµ (18ì„¸)',title:'ëŒ€í•™ì„ ì¤€ë¹„í•©ë‹ˆë‹¤',desc:'ìˆ˜ëŠ¥ì´ ë‹¤ê°€ì˜µë‹ˆë‹¤. ì–´ë–»ê²Œ ì¤€ë¹„í•˜ë‚˜ìš”?',
   choices:[
    {text:'ğŸ¢ ì¢…í•© ì…ì‹œ ì»¨ì„¤íŒ…',pts:20,icon:'ğŸ“ˆ',note:'ë¹„ìš© ìˆ˜ë°±ë§Œì›. ìˆ˜ì•„: ë§ì¶¤ ì „ëµ. ë¯¼ì¬: ë¶ˆê°€ëŠ¥.'},
    {text:'ğŸ“– í•™êµ ìˆ˜ì—… + EBS',pts:13,icon:'âœï¸',note:'ê³µêµìœ¡ ì¤‘ì‹¬. ì˜ì§€ê°€ ì¤‘ìš”.'},
    {text:'ğŸ’¼ ì·¨ì—… ì¤€ë¹„ ë³‘í–‰',pts:6,icon:'ğŸ”§',note:'ë¯¼ì¬ì²˜ëŸ¼ ê²½ì œì  í•„ìš”ê°€ ìˆëŠ” ê²½ìš°.'}
   ],
   insight:'ê°™ì€ ë…¸ë ¥ì´ë¼ë„ ê²°ê³¼ê°€ ë‹¤ë¦…ë‹ˆë‹¤. ëŒ€í•™ ì§„í•™ë¥ ì€ ë¶€ëª¨ ì†Œë“ê³¼ ê°•í•œ ìƒê´€ê´€ê³„ë¥¼ ë³´ì…ë‹ˆë‹¤. ì„œìš¸ëŒ€ í•™ìƒ ì¤‘ ê³ ì†Œë“ ê°€ì • ë¹„ìœ¨ì´ 61%ë¼ëŠ” í†µê³„(2023)ê°€ ì´ë¥¼ ë³´ì—¬ì¤ë‹ˆë‹¤.'},
  {stage:'ì·¨ì—… (25ì„¸)',title:'ì‚¬íšŒì— ì²«ë°œì„ ë‚´ë”›ìŠµë‹ˆë‹¤',desc:'ì–´ë–¤ ì§ì¥ì„ êµ¬í•˜ë‚˜ìš”?',
   choices:[
    {text:'ğŸ¢ ëŒ€ê¸°ì—… ì·¨ì—…',pts:22,icon:'ğŸ’¼',note:'ìˆ˜ì•„: ì¸í„´ ê²½í—˜ + ì–´í•™. ë¯¼ì¬: ì§€ì—­ í•œê³„. í•˜ë‚˜: í¸ê²¬.'},
    {text:'ğŸª ì¤‘ì†Œê¸°ì—… / ê³µë¬´ì›',pts:14,icon:'ğŸ›ï¸',note:'ì•ˆì •ì . ì§€ì—­ ì°¨ì´ ì ìŒ.'},
    {text:'ğŸš€ ì°½ì—… ë„ì „',pts:8,icon:'ğŸ’¡',note:'ì„±ê³µí•˜ë©´ í¬ì§€ë§Œ, ìë³¸ í•„ìš”. ì‹¤íŒ¨ ë¦¬ìŠ¤í¬ í¼.'}
   ],
   insight:'ì·¨ì—…ì—ì„œë„ ì¶œì‹  ì§€ì—­, ëŒ€í•™, ë¶€ëª¨ì˜ ë„¤íŠ¸ì›Œí¬ê°€ ì˜í–¥ì„ ë¯¸ì¹©ë‹ˆë‹¤. "í•™ë²Œ-ì§€ì—­-ë¶€ëª¨ ë°°ê²½"ì´ë¼ëŠ” 3ì¤‘ í•„í„°ê°€ ì¡´ì¬í•©ë‹ˆë‹¤. ë¸”ë¼ì¸ë“œ ì±„ìš©ì´ ë„ì…ëœ ì´ìœ ì´ê¸°ë„ í•©ë‹ˆë‹¤.'},
  {stage:'30ì„¸',title:'ìì‚°ì„ í˜•ì„±í•©ë‹ˆë‹¤',desc:'ì‚¬íšŒìƒí™œ 5ë…„ì°¨. ê²½ì œì  ê¸°ë°˜ì„ ìŒ“ìŠµë‹ˆë‹¤.',
   choices:[
    {text:'ğŸ  ë¶€ëª¨ ë„ì›€ + ë‚´ ì§‘ ë§ˆë ¨',pts:25,icon:'ğŸ¡',note:'ìˆ˜ì•„: ë¶€ëª¨ ì¦ì—¬. ë¯¼ì¬: í•™ìê¸ˆ ëŒ€ì¶œ ìƒí™˜ ì¤‘.'},
    {text:'ğŸ’° ì ê¸ˆ + ì†Œì•¡ íˆ¬ì',pts:15,icon:'ğŸ“Š',note:'ê¾¸ì¤€í•œ ì €ì¶•. ì‹œê°„ì´ í•„ìš”í•¨.'},
    {text:'ğŸ“š ìê¸°ê³„ë°œ íˆ¬ì',pts:10,icon:'ğŸ“',note:'ë¯¸ë˜ë¥¼ ìœ„í•œ íˆ¬ì. ë‹¹ì¥ ìì‚° ì¦ê°€ëŠ” ì ìŒ.'}
   ],
   insight:'30ì„¸ ìì‚° ê²©ì°¨ì˜ í•µì‹¬ì€ "ë¶€ëª¨ ìì‚°ì˜ ëŒ€ë¬¼ë¦¼"ì…ë‹ˆë‹¤. í•œêµ­ 20~30ëŒ€ì˜ ìì‚° ì¤‘ ìƒì†Â·ì¦ì—¬ ë¹„ì¤‘ì€ ìƒìœ„ 10%ì—ì„œ 45%ì— ë‹¬í•©ë‹ˆë‹¤. "ê¸ˆìˆ˜ì €Â·í™ìˆ˜ì €"ë¼ëŠ” ë§ì´ ë‚˜ì˜¨ ë°°ê²½ì…ë‹ˆë‹¤.'}
];

function show(id){document.querySelectorAll('.screen').forEach(s=>s.classList.remove('active'));document.getElementById(id).classList.add('active');window.scrollTo(0,0);}

function startGame(){
  stu.name=document.getElementById('input-name').value.trim()||'ìµëª…';
  stu.grade=document.getElementById('input-grade').value.trim();
  stu.cls=document.getElementById('input-class').value.trim();
  stu.num=document.getElementById('input-number').value.trim();
  document.documentElement.requestFullscreen().catch(()=>{});
  
  // random assign
  myChar=Math.floor(Math.random()*4);
  points={A:CHARS[0].startPt,B:CHARS[1].startPt,C:CHARS[2].startPt,D:CHARS[3].startPt};
  
  showAssign();
}

function showAssign(){
  const mc=CHARS[myChar];
  document.getElementById('assign-content').innerHTML=`
    <div class="text-5xl mb-4" style="animation:float 2s ease-in-out infinite">${mc.emoji}</div>
    <h2 class="jua text-2xl text-yellow-300 mb-2">ë‹¹ì‹ ì˜ ìºë¦­í„°ê°€ ë°°ì •ë˜ì—ˆìŠµë‹ˆë‹¤</h2>
    <div class="inline-block bg-yellow-900/30 border border-yellow-700 rounded-2xl p-6 mt-4 mb-6 text-left max-w-sm w-full">
      <div class="text-center mb-3"><span class="text-4xl">${mc.emoji}</span><div class="jua text-xl text-white mt-1">${mc.name}</div></div>
      <div class="space-y-2 text-sm">
        <p><span class="text-yellow-400">ğŸ  ë°°ê²½:</span> <span class="text-slate-300">${mc.bg}</span></p>
        <p><span class="text-yellow-400">ğŸ‘¨â€ğŸ‘©â€ğŸ‘§ ê°€ì¡±:</span> <span class="text-slate-300">${mc.family}</span></p>
        <p><span class="text-yellow-400">ğŸ“‹ íŠ¹ì§•:</span> <span class="text-slate-300">${mc.extra}</span></p>
        <p><span class="text-yellow-400">ğŸ“Š ì‹œì‘ ì ìˆ˜:</span> <span class="font-bold text-white">${mc.startPt}ì </span></p>
      </div>
    </div>
    <p class="text-slate-400 text-sm mb-4 max-w-sm mx-auto">4ëª… ëª¨ë‘ ê°™ì€ ì„ íƒì„ í•˜ì§€ë§Œ, ë°°ê²½ì— ë”°ë¼ ê²°ê³¼ê°€ ë‹¬ë¼ì§‘ë‹ˆë‹¤. 6ë¼ìš´ë“œë¥¼ ì§„í–‰í•˜ì„¸ìš”!</p>
    <div class="grid grid-cols-4 gap-2 max-w-md mx-auto mb-6">
      ${CHARS.map((c,i)=>`<div class="char-card ${i===myChar?'mine':''}"><div class="text-2xl">${c.emoji}</div><div class="text-xs font-bold ${i===myChar?'text-yellow-300':'text-slate-400'}">${c.name}</div><div class="text-xs text-slate-500">${c.bg}</div><div class="font-bold text-xs mt-1" style="color:${c.color}">${c.startPt}ì </div></div>`).join('')}
    </div>
    <button onclick="nextRound()" class="py-3 px-10 bg-yellow-600 hover:bg-yellow-500 text-white rounded-xl font-bold transition-all hover:scale-105">ì¸ìƒ ì‹œì‘ â†’</button>
  `;
  show('s-assign');
}

function nextRound(){
  if(round>=6){showResult();return;}
  const rd=ROUNDS[round];
  document.getElementById('r-num').textContent=round+1;
  document.getElementById('r-stage').textContent=rd.stage;
  document.getElementById('r-progress').style.width=(round/6*100)+'%';
  
  const ct=document.getElementById('r-content');
  ct.innerHTML=`
    <div class="max-w-2xl mx-auto">
      <div class="text-center mb-5 mt-4">
        <span class="text-xs px-3 py-1 rounded-full bg-slate-800 text-slate-400">${rd.stage}</span>
        <h2 class="jua text-2xl text-white mt-3 mb-1">${rd.title}</h2>
        <p class="text-slate-400 text-sm">${rd.desc}</p>
      </div>
      
      <div class="space-y-3 mb-6">
        ${rd.choices.map((ch,i)=>`
          <div class="choice-btn" onclick="makeChoice(${i})">
            <div class="flex items-start gap-3">
              <span class="text-2xl">${ch.icon}</span>
              <div class="flex-1">
                <div class="font-bold text-white text-sm">${ch.text}</div>
                <div class="text-xs text-slate-400 mt-1">${ch.note}</div>
              </div>
              <span class="stat-mini bg-purple-900/50 text-purple-300">+${ch.pts}pts</span>
            </div>
          </div>
        `).join('')}
      </div>
    </div>
  `;
  show('s-round');
}

function makeChoice(idx){
  const rd=ROUNDS[round];
  const ch=rd.choices[idx];
  
  // ì„ íƒ í‘œì‹œ
  document.querySelectorAll('.choice-btn').forEach((b,i)=>{
    if(i===idx)b.classList.add('selected');
    else{b.style.opacity='.3';b.style.pointerEvents='none';}
  });
  
  // 4ëª… ëª¨ë‘ ê°™ì€ ì„ íƒì„ í•œë‹¤ê³  ê°€ì • â†’ ê²°ê³¼ë§Œ ë‹¤ë¦„
  const results=CHARS.map((c,ci)=>{
    const mult=c.multipliers[round];
    const gained=Math.round(ch.pts*mult);
    points[c.id]+=gained;
    return {char:c,gained};
  });
  
  roundLog.push({stage:rd.stage,choice:ch.text,results});
  
  // ê²°ê³¼ ë¹„êµ í‘œì‹œ
  setTimeout(()=>{
    const ct=document.getElementById('r-content');
    const comp=document.createElement('div');
    comp.className='max-w-2xl mx-auto';
    comp.style.animation='fadeUp .5s ease-out forwards';
    comp.innerHTML=`
      <div class="mb-4">
        <div class="text-sm text-yellow-400 font-bold mb-3 text-center">ğŸ“Š ê°™ì€ ì„ íƒ, ë‹¤ë¥¸ ê²°ê³¼</div>
        <div class="grid grid-cols-4 gap-2 mb-4">
          ${results.map((r,i)=>`
            <div class="char-card ${i===myChar?'mine':''}">
              <div class="text-xl">${r.char.emoji}</div>
              <div class="text-xs font-bold" style="color:${r.char.color}">${r.char.name}</div>
              <div class="text-lg font-black text-white">+${r.gained}</div>
              <div class="text-xs text-slate-500">ì´ ${points[r.char.id]}ì </div>
            </div>
          `).join('')}
        </div>
        
        <!-- ì ìˆ˜ ë¹„êµ ë°” -->
        <div class="space-y-2 mb-4">
          ${CHARS.map(c=>`
            <div class="flex items-center gap-2 text-xs">
              <span class="w-8">${c.emoji}</span>
              <div class="flex-1 h-5 bg-slate-800 rounded-full overflow-hidden">
                <div class="h-full rounded-full transition-all" style="width:${Math.min(100,points[c.id]/3)}%;background:${c.color}"></div>
              </div>
              <span class="w-10 text-right font-bold" style="color:${c.color}">${points[c.id]}</span>
            </div>
          `).join('')}
        </div>
        
        <div class="insight-box">
          <div class="text-xs text-yellow-400 font-bold mb-1">ğŸ’¡ ì™œ ë‹¤ë¥¼ê¹Œ?</div>
          <p class="text-xs text-slate-300 leading-relaxed">${rd.insight}</p>
        </div>
      </div>
      <div class="text-center">
        <button onclick="round++;nextRound()" class="py-3 px-8 bg-yellow-600 hover:bg-yellow-500 text-white rounded-xl font-bold transition-all hover:scale-105">
          ${round<5?'ë‹¤ìŒ ë‹¨ê³„ â†’':'ìµœì¢… ê²°ê³¼ ë³´ê¸° â†’'}
        </button>
      </div>
    `;
    ct.appendChild(comp);
    comp.scrollIntoView({behavior:'smooth'});
  },500);
}

function showResult(){
  const mc=CHARS[myChar];
  const sorted=[...CHARS].sort((a,b)=>points[b.id]-points[a.id]);
  const gap=points[sorted[0].id]-points[sorted[3].id];
  const myRank=sorted.findIndex(c=>c.id===mc.id)+1;
  
  // gini coefficient calculation
  const vals=CHARS.map(c=>points[c.id]).sort((a,b)=>a-b);
  const n=vals.length, mean=vals.reduce((a,b)=>a+b)/n;
  let giniSum=0;
  for(let i=0;i<n;i++)for(let j=0;j<n;j++)giniSum+=Math.abs(vals[i]-vals[j]);
  const gini=(giniSum/(2*n*n*mean)).toFixed(2);
  
  document.getElementById('res-subtitle').textContent=`${stu.grade?stu.grade+'í•™ë…„ ':''}${stu.cls?stu.cls+'ë°˜ ':''}${stu.name} (${mc.name} ì—­í• )`;
  
  document.getElementById('res-body').innerHTML=`
    <div class="text-center mb-5">
      <div class="text-4xl mb-2">${mc.emoji}</div>
      <div class="jua text-xl">${mc.name}ì˜ 30ì„¸ â€” ${myRank}ìœ„</div>
      <div class="text-2xl font-black mt-1" style="color:${mc.color}">${points[mc.id]}ì </div>
    </div>
    
    <!-- ìµœì¢… ìˆœìœ„ -->
    <div class="space-y-2 mb-5">
      ${sorted.map((c,i)=>`
        <div class="flex items-center gap-3 p-2 rounded-lg ${c.id===mc.id?'bg-yellow-50 border border-yellow-200':'bg-slate-50'}">
          <span class="text-lg font-black" style="color:${c.color}">${i+1}ìœ„</span>
          <span class="text-2xl">${c.emoji}</span>
          <div class="flex-1">
            <div class="font-bold text-sm">${c.name} <span class="text-xs text-slate-400">${c.bg}</span></div>
            <div class="w-full h-3 bg-slate-200 rounded-full mt-1"><div class="h-full rounded-full" style="width:${points[c.id]/3}%;background:${c.color}"></div></div>
          </div>
          <span class="font-black" style="color:${c.color}">${points[c.id]}ì </span>
        </div>
      `).join('')}
    </div>
    
    <div class="bg-red-50 rounded-xl p-4 mb-5 text-center">
      <div class="text-sm text-red-800 font-bold mb-1">ğŸ“Š ê²©ì°¨ ë¶„ì„</div>
      <div class="grid grid-cols-2 gap-3 text-center">
        <div><div class="text-2xl font-black text-red-600">${gap}ì </div><div class="text-xs text-red-500">1ìœ„-4ìœ„ ê²©ì°¨</div></div>
        <div><div class="text-2xl font-black text-red-600">${gini}</div><div class="text-xs text-red-500">ì§€ë‹ˆê³„ìˆ˜</div></div>
      </div>
      <p class="text-xs text-red-600 mt-2">${gini>=0.4?'ë§¤ìš° ë¶ˆí‰ë“±í•œ ì‚¬íšŒ':gini>=0.3?'ë¶ˆí‰ë“±ì´ ì¡´ì¬í•˜ëŠ” ì‚¬íšŒ':'ë¹„êµì  í‰ë“±í•œ ì‚¬íšŒ'}ì…ë‹ˆë‹¤</p>
    </div>
    
    <!-- ë§Œì•½ ì •ì±…ì´ ìˆì—ˆë‹¤ë©´? -->
    <div class="bg-purple-50 rounded-xl p-4 mb-5">
      <div class="text-sm text-purple-800 font-bold mb-2">ğŸ›ï¸ ë§Œì•½ ì´ëŸ° ì •ì±…ì´ ìˆì—ˆë‹¤ë©´?</div>
      <div class="space-y-2 text-xs text-purple-900">
        <p>ğŸ“Œ <b>ë¬´ìƒêµìœ¡ í™•ëŒ€</b> â†’ ë¯¼ì¬ì˜ êµìœ¡ ê²©ì°¨ -40% ê°ì†Œ</p>
        <p>ğŸ“Œ <b>ì§€ì—­ ê· í˜• ë°œì „</b> â†’ ì¤€í˜¸Â·ë¯¼ì¬ì˜ ê¸°íšŒ ê²©ì°¨ -30% ê°ì†Œ</p>
        <p>ğŸ“Œ <b>ë‹¤ë¬¸í™” ì§€ì› ê°•í™”</b> â†’ í•˜ë‚˜ì˜ ì–¸ì–´Â·ë¬¸í™” ì¥ë²½ -50% ê°ì†Œ</p>
        <p>ğŸ“Œ <b>ê¸°ë³¸ì†Œë“ ë„ì…</b> â†’ ì „ì²´ ìµœì € ì ìˆ˜ +20ì  ìƒìŠ¹</p>
        <p style="color:#7c3aed;margin-top:8px">â†’ ì •ì±… í•˜ë‚˜ë¡œ ì§€ë‹ˆê³„ìˆ˜ê°€ ${(gini-0.08).toFixed(2)}ë¡œ ê°œì„ ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤</p>
      </div>
    </div>
    
    <div class="bg-amber-50 rounded-xl p-4 mb-5">
      <div class="text-sm text-amber-800 font-bold mb-2">ğŸ¤” ìƒê°í•´ë³¼ ì§ˆë¬¸</div>
      <div class="text-xs text-amber-900 space-y-1">
        <p>â€¢ ì´ ê²Œì„ì—ì„œ "ê³µì •í•œ ê²½ìŸ"ì´ ì´ë£¨ì–´ì¡Œë‹¤ê³  ìƒê°í•˜ë‚˜ìš”?</p>
        <p>â€¢ ê²°ê³¼ì˜ ì°¨ì´ëŠ” "ë…¸ë ¥ì˜ ì°¨ì´"ì¸ê°€ìš”, "í™˜ê²½ì˜ ì°¨ì´"ì¸ê°€ìš”?</p>
        <p>â€¢ ë¡¤ìŠ¤(Rawls)ì˜ 'ë¬´ì§€ì˜ ë² ì¼' â€” ë‚´ê°€ ëˆ„êµ¬ë¡œ íƒœì–´ë‚ ì§€ ëª¨ë¥¸ë‹¤ë©´ ì–´ë–¤ ì‚¬íšŒë¥¼ ì„¤ê³„í•˜ê² ìŠµë‹ˆê¹Œ?</p>
      </div>
    </div>
    
    <div class="bg-blue-50 border border-blue-200 rounded-xl p-4 mb-4">
      <h3 class="font-bold text-sm text-blue-800 mb-2">ğŸ“š êµê³¼ì„œ ì—°ê²°</h3>
      <div class="text-xs text-blue-700 space-y-1">
        <p><b>ë‹¨ì›:</b> í†µí•©ì‚¬íšŒ V. ì‚¬íšŒì •ì˜ì™€ ë¶ˆí‰ë“±</p>
        <p><b>ì„±ì·¨ê¸°ì¤€:</b> [10í†µì‚¬2-02-01] ì‚¬íšŒ ë¶ˆí‰ë“± í˜„ìƒì˜ ë‹¤ì–‘í•œ ì–‘ìƒì„ ì´í•´í•˜ê³ , ì •ì˜ë¡œìš´ ì‚¬íšŒë¥¼ ì‹¤í˜„í•˜ê¸° ìœ„í•œ ë°©ì•ˆì„ íƒêµ¬í•œë‹¤.</p>
        <p><b>í•µì‹¬ ê°œë…:</b> ì‚¬íšŒ ë¶ˆí‰ë“±ì€ ê²½ì œì  ìš”ì¸ë¿ ì•„ë‹ˆë¼ ì§€ì—­, í•™ë ¥, ì„±ë³„, ë¬¸í™”ì  ë°°ê²½ ë“± ë³µí•©ì  ìš”ì¸ì— ì˜í•´ ë°œìƒí•©ë‹ˆë‹¤. <b>ë¡¤ìŠ¤ì˜ ì •ì˜ë¡ </b>ì€ "ìµœì†Œ ìˆ˜í˜œìì—ê²Œ ìµœëŒ€ ì´ìµ"ì„ ì£¼ëŠ” ì‚¬íšŒê°€ ì •ì˜ë¡­ë‹¤ê³  ì£¼ì¥í•©ë‹ˆë‹¤. <b>ì§€ë‹ˆê³„ìˆ˜</b>ëŠ” 0(ì™„ì „ í‰ë“±)~1(ì™„ì „ ë¶ˆí‰ë“±)ë¡œ ì†Œë“ ë¶„ë°° ìƒíƒœë¥¼ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.</p>
        <p><b>í™•ì¥:</b> í•œêµ­ì˜ ì§€ë‹ˆê³„ìˆ˜ëŠ” ì•½ 0.33(2023)ìœ¼ë¡œ, OECD í‰ê· ê³¼ ë¹„ìŠ·í•˜ì§€ë§Œ ìì‚° ë¶ˆí‰ë“±ì€ ë” ì‹¬ê°í•©ë‹ˆë‹¤. ì„¸ëŒ€ ê°„ ê³„ì¸µ ì´ë™ì„±(ë¶€ëª¨ ì„¸ëŒ€ â†’ ìë…€ ì„¸ëŒ€ë¡œ ì‚¬íšŒì  ì§€ìœ„ê°€ ë³€í•˜ëŠ” ì •ë„)ì´ ë‚®ì•„ì§€ê³  ìˆë‹¤ëŠ” ìš°ë ¤ê°€ ìˆìŠµë‹ˆë‹¤.</p>
      </div>
    </div>
    <div class="text-center text-xs text-slate-400 mt-3"><p>ì¶œë°œì„ ì´ ë‹¤ë¥¸ ì¸ìƒê²Œì„ Â· í†µí•©ì‚¬íšŒ Â· ê¹€ìŠ¤ë°ë°˜ T</p><p>${new Date().toLocaleDateString('ko-KR')}</p></div>
  `;
  missionComplete=true;
  if(document.fullscreenElement)document.exitFullscreen().catch(()=>{});
  show('s-result');
}

function saveImg(){html2canvas(document.getElementById('result-card'),{scale:2,backgroundColor:'#fff'}).then(c=>{const a=document.createElement('a');a.download=`ì¸ìƒê²Œì„_${stu.name}_${new Date().toISOString().slice(0,10)}.png`;a.href=c.toDataURL('image/png');a.click();}).catch(()=>alert('ì €ì¥ ì‹¤íŒ¨'));}
function exitToBlog(){
  missionComplete = true;
  if(document.fullscreenElement)document.exitFullscreen().catch(()=>{});
  if(document.referrer&&document.referrer.includes('blogspot'))window.location.href=document.referrer;
  else window.history.back();
}
// ===== ì „ì²´í™”ë©´ ê°€ë“œ =====
let missionComplete = false;
let isReEntering = false;

function reEnterFullscreen(){
  isReEntering = true;
  document.getElementById('fs-warning').style.display = 'none';
  document.documentElement.requestFullscreen().catch(()=>{isReEntering=false;});
}

document.addEventListener('fullscreenchange', () => {
  if(!document.fullscreenElement && !missionComplete && !isReEntering){
    const cur = document.querySelector('.screen.active');
    if(cur && cur.id !== 's-start' && cur.id !== 's-intro'){
      document.getElementById('fs-warning').style.display = 'flex';
    }
  }
  if(document.fullscreenElement){
    isReEntering = false;
    document.getElementById('fs-warning').style.display = 'none';
  }
});

</script>
<!-- ì „ì²´í™”ë©´ ì´íƒˆ ê²½ê³  ì˜¤ë²„ë ˆì´ -->
<div class="fs-warning-overlay" id="fs-warning" style="display:none">
  <div class="warn-icon">âš ï¸</div>
  <div class="warn-title">ë¯¸ì…˜ ì§„í–‰ ì¤‘ì…ë‹ˆë‹¤!</div>
  <div class="warn-msg">ì „ì²´í™”ë©´ì„ ìœ ì§€í•´ì•¼ ë¯¸ì…˜ì„ ê³„ì†í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.<br>ë‹¤ì‹œ ì „ì²´í™”ë©´ìœ¼ë¡œ ëŒì•„ê°€ì„¸ìš”.</div>
  <button class="warn-btn" onclick="reEnterFullscreen()">ğŸ”’ ì „ì²´í™”ë©´ìœ¼ë¡œ ëŒì•„ê°€ê¸°</button>
</div>
<!-- ë¸”ë¡œê·¸ ë§í¬ ë°°ì§€ -->
<a href="https://ssam-ssong.blogspot.com" target="_blank" class="blog-badge">âœï¸ í’€ì–´ì“°ëŠ” ì‚¬íšŒí•™</a>
</body>
</html>
